version: 0.1
log:
  accesslog:
    disabled: false
  level: info
  formatter: text
  fields:
    service: registry
    environment: production

storage:
  filesystem:
    rootdirectory: /var/lib/registry
  delete:
    enabled: true

http:
  addr: :5000
  headers:
    X-Content-Type-Options: [nosniff]
  debug:
    addr: :5001
    prometheus:
      enabled: true
      path: /metrics

auth:
  token:
    realm: http://localhost/api/auth/token/
    service: docker-platform-registry
    issuer: docker-platform
    rootcertbundle: /certs/jwt.crt

notifications:
  endpoints:
    - name: django-webhook
      url: http://web:8000/api/webhooks/registry/
      timeout: 5s
      threshold: 3
      backoff: 1s
      headers:
        Content-Type: ["application/vnd.docker.distribution.events.v2+json"]
        User-Agent: ["Docker-Registry-Notification/1.0"]

health:
  storagedriver:
    enabled: true
    interval: 10s
    threshold: 3